(window.webpackJsonp=window.webpackJsonp||[]).push([[556],{1141:function(e,t,n){"use strict";var a=n(24),r=n(13),i=n(27),s=n(84),o=n(85),c=n(26),l=n(1147),u=n(86);r(r.S+r.F*!n(81)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,r,m,p=i(e),b="function"==typeof this?this:Array,d=arguments.length,h=d>1?arguments[1]:void 0,f=void 0!==h,g=0,O=u(p);if(f&&(h=a(h,d>2?arguments[2]:void 0,2)),null==O||b==Array&&o(O))for(n=new b(t=c(p.length));t>g;g++)l(n,g,f?h(p[g],g):p[g]);else for(m=O.call(p),n=new b;!(r=m.next()).done;g++)l(n,g,f?s(m,h,[r.value,g],!0):r.value);return n.length=g,n}})},1142:function(e,t,n){"use strict";var a=n(1148),r=n(1143);e.exports=n(1149)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return a.def(r(this,"Set"),e=0===e?0:e,e)}},a)},1143:function(e,t,n){var a=n(12);e.exports=function(e,t){if(!a(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},1144:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(1139),s=n(1138),o=n.n(s);n(131);t.a=function(e){var t=e.className,n=e.size,a=e.style,s=e.text;return r.a.createElement(i.a,{to:"/vic/",className:o()("vic","vic--"+n,t)},r.a.createElement("div",{className:"icon"},r.a.createElement("img",{src:"/img/vicmojis/vic"+a+".svg",alt:"Vic - The Vector Mascot"})),s&&r.a.createElement("div",{className:"text"},s))}},1146:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=(n(1139),n(1144));t.a=function(e){var t=e.text;return r.a.createElement("section",{className:"empty"},r.a.createElement(i.a,{style:"no",text:t}))}},1147:function(e,t,n){"use strict";var a=n(28),r=n(53);e.exports=function(e,t,n){t in e?a.f(e,t,r(0,n)):e[t]=n}},1148:function(e,t,n){"use strict";var a=n(28).f,r=n(82),i=n(80),s=n(24),o=n(78),c=n(79),l=n(54),u=n(83),m=n(87),p=n(10),b=n(1145).fastKey,d=n(1143),h=p?"_s":"size",f=function(e,t){var n,a=b(t);if("F"!==a)return e._i[a];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,l){var u=e((function(e,a){o(e,u,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[h]=0,null!=a&&c(a,n,e[l],e)}));return i(u.prototype,{clear:function(){for(var e=d(this,t),n=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete n[a.i];e._f=e._l=void 0,e[h]=0},delete:function(e){var n=d(this,t),a=f(n,e);if(a){var r=a.n,i=a.p;delete n._i[a.i],a.r=!0,i&&(i.n=r),r&&(r.p=i),n._f==a&&(n._f=r),n._l==a&&(n._l=i),n[h]--}return!!a},forEach:function(e){d(this,t);for(var n,a=s(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(a(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!f(d(this,t),e)}}),p&&a(u.prototype,"size",{get:function(){return d(this,t)[h]}}),u},def:function(e,t,n){var a,r,i=f(e,t);return i?i.v=n:(e._l=i={i:r=b(t,!0),k:t,v:n,p:a=e._l,n:void 0,r:!1},e._f||(e._f=i),a&&(a.n=i),e[h]++,"F"!==r&&(e._i[r]=i)),e},getEntry:f,setStrong:function(e,t,n){l(e,t,(function(e,n){this._t=d(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))}),n?"entries":"values",!n,!0),m(t)}}},1149:function(e,t,n){"use strict";var a=n(5),r=n(13),i=n(15),s=n(80),o=n(1145),c=n(79),l=n(78),u=n(12),m=n(14),p=n(81),b=n(40),d=n(1150);e.exports=function(e,t,n,h,f,g){var O=a[e],v=O,j=f?"set":"add",y=v&&v.prototype,_={},N=function(e){var t=y[e];i(y,e,"delete"==e||"has"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof v&&(g||y.forEach&&!m((function(){(new v).entries().next()})))){var k=new v,E=k[j](g?{}:-0,1)!=k,w=m((function(){k.has(1)})),x=p((function(e){new v(e)})),T=!g&&m((function(){for(var e=new v,t=5;t--;)e[j](t,t);return!e.has(-0)}));x||((v=t((function(t,n){l(t,v,e);var a=d(new O,t,v);return null!=n&&c(n,f,a[j],a),a}))).prototype=y,y.constructor=v),(w||T)&&(N("delete"),N("has"),f&&N("get")),(T||E)&&N(j),g&&y.clear&&delete y.clear}else v=h.getConstructor(t,e,f,j),s(v.prototype,n),o.NEED=!0;return b(v,e),_[e]=v,r(r.G+r.W+r.F*(v!=O),_),g||h.setStrong(v,e,f),v}},1150:function(e,t,n){var a=n(12),r=n(1151).set;e.exports=function(e,t,n){var i,s=t.constructor;return s!==n&&"function"==typeof s&&(i=s.prototype)!==n.prototype&&a(i)&&r&&r(e,i),e}},1151:function(e,t,n){var a=n(12),r=n(8),i=function(e,t){if(r(e),!a(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,a){try{(a=n(24)(Function.call,n(1168).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(r){t=!0}return function(e,n){return i(e,n),t?e.__proto__=n:a(e,n),e}}({},!1):void 0),check:i}},1152:function(e,t,n){"use strict";n(1142),n(77),n(1141),n(25),n(20),n(19),n(1140);var a=n(0),r=n.n(a),i=n(1161),s=n.n(i);t.a=function(e){var t=e.currentState,n=e.humanize,a=e.icon,i=e.name,o=e.setState,c=e.values;if(0==c.size)return null;var l=Array.from(c);return r.a.createElement(r.a.Fragment,null,l.map((function(e,c){var l="string"==typeof e&&n?s()(e):e;return r.a.createElement("label",{key:c},r.a.createElement("input",{checked:t.has(e),name:i,onChange:function(n){var a=new Set(t);n.currentTarget.checked?a.add(e):a.delete(e),o(a)},type:"checkbox"}),l&&r.a.createElement(r.a.Fragment,null,a?r.a.createElement("i",{className:"feather icon-"+a}):""," ",l))})))}},1155:function(e,t,n){"use strict";var a=n(13),r=n(1156),i=n(27),s=n(26),o=n(29),c=n(1171);a(a.P,"Array",{flatMap:function(e){var t,n,a=i(this);return o(e),t=s(a.length),n=c(a,0),r(n,a,a,t,0,1,e,arguments[1]),n}}),n(88)("flatMap")},1156:function(e,t,n){"use strict";var a=n(1170),r=n(12),i=n(26),s=n(24),o=n(2)("isConcatSpreadable");e.exports=function e(t,n,c,l,u,m,p,b){for(var d,h,f=u,g=0,O=!!p&&s(p,b,3);g<l;){if(g in c){if(d=O?O(c[g],g,n):c[g],h=!1,r(d)&&(h=void 0!==(h=d[o])?!!h:a(d)),h&&m>0)f=e(t,n,d,i(d.length),f,m-1)-1;else{if(f>=9007199254740991)throw TypeError();t[f]=d}f++}g++}return f}},1159:function(e,t,n){"use strict";n(1140),n(1153),n(1154),n(1141),n(1155),n(25),n(20),n(19),n(77),n(1142);var a=n(0),r=n.n(a),i=n(1152),s=n(1146),o=n(1163),c=n.n(o);t.a=function(e){var t=e.children,n=e.filters,o=Object(a.useState)(!1),l=o[0],u=o[1],m=Object(a.useState)(new Set),p=m[0],b=m[1],d=Object(a.useState)(!1),h=d[0],f=d[1],g=Object(a.useState)(null),O=g[0],v=g[1],j=[];t&&(j=Array.isArray(t)?t:[t]);var y=j.some((function(e){return e.props.common})),_=c()(j).flatMap((function(e){return e.props.groups})).uniq().value(),N=j.some((function(e){return e.props.required})),k=j;return l&&(k=k.filter((function(e){return e.props.common}))),p.size>0&&(k=k.filter((function(e){return Array.from(p).every((function(t){return e.props.groups.includes(t)}))}))),h&&(k=k.filter((function(e){return e.props.required}))),O&&(k=k.filter((function(e){return e.props.name.toLowerCase().includes(O.toLowerCase())}))),r.a.createElement(r.a.Fragment,null,j.length>1&&!1!==n?r.a.createElement("div",{className:"filters"},r.a.createElement("div",{className:"search"},r.a.createElement("span",{className:"search--result-count"},k.length," items"),r.a.createElement("input",{className:"input--text input--lg",type:"text",onChange:function(e){return v(e.currentTarget.value)},placeholder:"\ud83d\udd0d Search..."})),r.a.createElement("div",{className:"filter"},r.a.createElement("div",{className:"filter--choices"},r.a.createElement(i.a,{values:_,currentState:p,setState:b}),y&&r.a.createElement("label",{title:"Only show popular/common results"},r.a.createElement("input",{type:"checkbox",onChange:function(e){return u(e.currentTarget.checked)},checked:l}),"common"),N&&r.a.createElement("label",{title:"Only show required results"},r.a.createElement("input",{type:"checkbox",onChange:function(e){return f(e.currentTarget.checked)},checked:h}),"required")))):null,!Array.isArray(k)||k.length>0?r.a.createElement("ul",{className:"connected-list"},k):r.a.createElement(s.a,{text:"no components found"}))}},1160:function(e,t,n){"use strict";n(89),n(25),n(20),n(19),n(52),n(1140),n(1153),n(1154);var a=n(0),r=n.n(a),i=n(1138),s=n.n(i),o=(n(1130),n(1172));function c(e){return e.includes(".")?'"'+e+'"':e}function l(e){return"string"==typeof e&&e.includes("\n")?'"""\n'+e+'\n"""':JSON.stringify(e)}function u(e,t){return(n=t)&&n.constructor===Object?"name"in t&&"value"in t?c(t.name)+" = "+l(t.value):c(Object.keys(t)[0])+" = "+l(Object.values(t)[0]):e?c(e)+" = "+l(t):l(t);var n}function m(e){var t=e.values,n=[];if(Array.isArray(t))for(var a in t){var i=t[a];n.push(r.a.createElement("code",{key:i},l(i))),n.push(" ")}else for(var s in t)n.push(r.a.createElement("code",{key:s,className:"with-info-icon",title:t[s]},l(s))),n.push(" ");return n}function p(e){var t=e.name,n=e.path,a=e.values,i="";return a.forEach((function(e){n&&(i+=n+"."),i+=u(t,e)+"\n"})),r.a.createElement("div",null,r.a.createElement(o.a,{className:"language-toml"},i))}function b(e){var t=e.unit,n=e.value,a="";return t&&(a=r.a.createElement(r.a.Fragment,null," (",t,")")),r.a.createElement(r.a.Fragment,null,r.a.createElement("code",null,l(n)),a)}function d(e){var t=e.value,n=Object.keys(t)[0],a=Object.values(t)[0];return""==a&&(a=null),r.a.createElement("span",null,r.a.createElement("code",null,r.a.createElement("a",{href:"#"+n},n))," ","= ",r.a.createElement("code",null,l(a)))}function h(e){var t=e.defaultValue,n=e.enumValues,i=e.examples,s=(e.groups,e.name),o=e.path,c=e.relevantWhen,l=e.required,u=e.unit,h=e.warnings,f=Object(a.useState)(!1),g=f[0],O=f[1];return r.a.createElement("ul",{className:"info"},h&&h.length>0&&h.map((function(e,t){return r.a.createElement("li",{key:t,className:"warning"},r.a.createElement("i",{className:"feather icon-alert-triangle"})," WARNING:"," ",e.text)})),c&&r.a.createElement("li",null,"Only ",l?"required":"relevant"," when:"," ",r.a.createElement(d,{value:c})),void 0!==t?null!==t?r.a.createElement("li",null,"Default: ",r.a.createElement(b,{unit:u,value:t})):r.a.createElement("li",null,"No default"):null,n&&r.a.createElement("li",null,"Enum, must be one of: ",r.a.createElement(m,{values:n})),(i.length>1||i[0]!=t)&&r.a.createElement("li",null,r.a.createElement("div",{className:"show-more",onClick:function(){return O(!g)}},g?"Hide examples":"View examples"),g&&r.a.createElement(p,{name:s,path:o,values:i})))}t.a=function(e){var t=e.children,n=e.common,i=e.defaultValue,o=e.enumValues,c=e.examples,l=e.groups,u=e.name,m=e.path,p=e.relevantWhen,b=e.required,d=e.templateable,f=e.type,g=e.unit,O=e.warnings,v=Object(a.useState)(!1),j=v[0],y=(v[1],t);return j&&(y=y.filter((function(e){return"p"!=e.props.originalType}))),r.a.createElement("li",{className:s()({"field-required":b,"field-collapsed":j}),required:b},r.a.createElement("div",{className:"badges"},d&&r.a.createElement("span",{className:"badge badge--primary with-info-icon",title:"This option is dynamic and accepts the Vector template syntax"},"templateable"),f&&r.a.createElement("span",{className:"badge badge--secondary"},f,g&&r.a.createElement(r.a.Fragment,null," (",g,")")),o&&Object.keys(o).length>0&&r.a.createElement("span",{className:"badge badge--secondary with-info-icon",title:"This option is an enumation and only allows specific values"},"enum"),n&&r.a.createElement("span",{className:"badge badge--primary with-info-icon",title:"This is a popular that we recommend for getting started"},"common"),b?r.a.createElement("span",{className:"badge badge--danger"},"required",p&&"*"):r.a.createElement("span",{className:"badge badge--secondary"},"optional")),y,!j&&"table"!=f&&r.a.createElement(h,{defaultValue:i,enumValues:o,examples:c,groups:l,name:u,path:m,relevantWhen:p,required:b,unit:g,warnings:O}))}},712:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return u})),n.d(t,"metadata",(function(){return m})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return d}));var a=n(1),r=(n(0),n(1130)),i=n(1174),s=n(1159),o=n(1160),c=n(1165),l=n(1164);const u={last_modified_on:"2020-05-21",delivery_guarantee:"best_effort",component_title:"Prometheus",description:"The Vector `prometheus` sink exposes `metric` events to Prometheus metrics service.",event_types:["metric"],function_category:"transmit",issues_url:"https://github.com/timberio/vector/issues?q=is%3Aopen+is%3Aissue+label%3A%22sink%3A+prometheus%22",operating_systems:["Linux","MacOS","Windows"],sidebar_label:'prometheus|["metric"]',source_url:"https://github.com/timberio/vector/tree/master/src/sinks/prometheus.rs",status:"beta",title:"Prometheus Sink",unsupported_operating_systems:[]},m={id:"reference/sinks/prometheus",title:"Prometheus Sink",description:"The Vector `prometheus` sink exposes `metric` events to Prometheus metrics service.",source:"@site/docs/reference/sinks/prometheus.md",permalink:"/docs/reference/sinks/prometheus",sidebar_label:'prometheus|["metric"]'},p=[{value:"Requirements",id:"requirements",children:[]},{value:"Configuration",id:"configuration",children:[{value:"address",id:"address",children:[]},{value:"buckets",id:"buckets",children:[]},{value:"flush_period_secs",id:"flush_period_secs",children:[]},{value:"namespace",id:"namespace",children:[]}]},{value:"Examples",id:"examples",children:[]},{value:"How It Works",id:"how-it-works",children:[{value:"Buffers",id:"buffers",children:[]},{value:"Environment Variables",id:"environment-variables",children:[]},{value:"Exposing &amp; Scraping",id:"exposing--scraping",children:[]},{value:"High Cardinality Names",id:"high-cardinality-names",children:[]},{value:"Histogram Buckets",id:"histogram-buckets",children:[]},{value:"In-Memory Aggregation",id:"in-memory-aggregation",children:[]},{value:"Metric Definitions",id:"metric-definitions",children:[]},{value:"Metric Types",id:"metric-types",children:[]}]}],b={rightToc:p};function d({components:e,...t}){return Object(r.b)("wrapper",Object(a.a)({},b,t,{components:e,mdxType:"MDXLayout"}),Object(r.b)("p",null,"The Vector ",Object(r.b)("inlineCode",{parentName:"p"},"prometheus")," sink\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#exposing--scraping"}),"exposes")," ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/about/data-model/metric/"}),Object(r.b)("inlineCode",{parentName:"a"},"metric"))," events to\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://prometheus.io/"}),"Prometheus")," metrics service."),Object(r.b)("h2",{id:"requirements"},"Requirements"),Object(r.b)(i.a,{icon:!1,type:"danger",className:"list--icons list--icons--warnings",mdxType:"Alert"},Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://prometheus.io/"}),"Prometheus")," version ",Object(r.b)("inlineCode",{parentName:"li"},">= 1.0")," is required."))),Object(r.b)("h2",{id:"configuration"},"Configuration"),Object(r.b)(c.a,{block:!0,defaultValue:"common",values:[{label:"Common",value:"common"},{label:"Advanced",value:"advanced"}],mdxType:"Tabs"},Object(r.b)(l.a,{value:"common",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-toml",metastring:'title="vector.toml"',title:'"vector.toml"'}),'[sinks.my_sink_id]\n  type = "prometheus" # required\n  inputs = ["my-source-or-transform-id"] # required\n  address = "0.0.0.0:9598" # required\n  namespace = "service" # required\n'))),Object(r.b)(l.a,{value:"advanced",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-toml",metastring:'title="vector.toml"',title:'"vector.toml"'}),'[sinks.my_sink_id]\n  type = "prometheus" # required\n  inputs = ["my-source-or-transform-id"] # required\n  address = "0.0.0.0:9598" # required\n  buckets = [0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1.0, 2.5, 5.0, 10.0] # optional, default, seconds\n  flush_period_secs = 60 # optional, default, seconds\n  namespace = "service" # required\n')))),Object(r.b)(s.a,{filters:!0,mdxType:"Fields"},Object(r.b)(o.a,{common:!0,defaultValue:null,enumValues:null,examples:["0.0.0.0:9598"],groups:[],name:"address",path:null,relevantWhen:null,required:!0,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"address"},"address"),Object(r.b)("p",null,"The address to expose for scraping.\nSee ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#exposing--scraping"}),"Exposing & Scraping")," for more info.")),Object(r.b)(o.a,{common:!1,defaultValue:[.005,.01,.025,.05,.1,.25,.5,1,2.5,5,10],enumValues:null,examples:[[.005,.01,.025,.05,.1,.25,.5,1,2.5,5,10]],groups:[],name:"buckets",path:null,relevantWhen:null,required:!1,templateable:!1,type:"[float]",unit:"seconds",warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"buckets"},"buckets"),Object(r.b)("p",null,"Default buckets to use for aggregating\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/about/data-model/metric/#distribution"}),"distribution")," metrics into histograms.\nSee ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#histogram-buckets"}),"Histogram Buckets")," for more info.")),Object(r.b)(o.a,{common:!1,defaultValue:60,enumValues:null,examples:[60],groups:[],name:"flush_period_secs",path:null,relevantWhen:null,required:!1,templateable:!1,type:"uint",unit:"seconds",warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"flush_period_secs"},"flush_period_secs"),Object(r.b)("p",null,"Time interval between ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/about/data-model/metric/#set"}),"set")," values are reset.")),Object(r.b)(o.a,{common:!0,defaultValue:null,enumValues:null,examples:["service"],groups:[],name:"namespace",path:null,relevantWhen:null,required:!0,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"namespace"},"namespace"),Object(r.b)("p",null,"A prefix that will be added to all metric names.\nIt should follow Prometheus ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://prometheus.io/docs/practices/naming/#metric-names"}),"naming conventions"),"."))),Object(r.b)("h2",{id:"examples"},"Examples"),Object(r.b)(c.a,{block:!0,defaultValue:"histograms",select:!1,values:[{label:"Histograms",value:"histograms"},{label:"Counters",value:"counters"},{label:"Gauges",value:"gauges"}],mdxType:"Tabs"},Object(r.b)(l.a,{value:"histograms",mdxType:"TabItem"},Object(r.b)("p",null,"Given the following histogram metric events:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json",metastring:'title="Example histogram metrics"',title:'"Example',histogram:!0,'metrics"':!0}),'[\n  {\n    "name": "response_time_s",\n    "kind": "incremental",\n    "value": {\n      "type": "distribution",\n      "values": [0.243],\n      "sample_rates": [1.0]\n    }\n  },\n  {\n    "name": "response_time_s",\n    "kind": "incremental",\n    "value": {\n      "type": "distribution",\n      "values": [0.546],\n      "sample_rates": [1.0]\n    }\n  }\n]\n')),Object(r.b)("p",null,"This sink will output the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text",metastring:'title="Example sink output"',title:'"Example',sink:!0,'output"':!0}),'# HELP response_time_s response_time_s\n# TYPE response_time_s histogram\nresponse_time_s_bucket{le="0.005"} 0\nresponse_time_s_bucket{le="0.01"} 1\nresponse_time_s_bucket{le="0.025"} 0\nresponse_time_s_bucket{le="0.05"} 1\nresponse_time_s_bucket{le="0.1"} 0\nresponse_time_s_bucket{le="0.25"} 0\nresponse_time_s_bucket{le="0.5"} 0\nresponse_time_s_bucket{le="1.0"} 0\nresponse_time_s_bucket{le="2.5"} 0\nresponse_time_s_bucket{le="5.0"} 0\nresponse_time_s_bucket{le="10.0"} 0\nresponse_time_s_bucket{le="+Inf"} 0\nresponse_time_s_sum 0.789\nresponse_time_s_count 2\n'))),Object(r.b)(l.a,{value:"counters",mdxType:"TabItem"},Object(r.b)("p",null,"Given the following counter metric events:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json",metastring:'title="Example counter metrics"',title:'"Example',counter:!0,'metrics"':!0}),'[\n  {\n    "name": "logins",\n    "kind": "incremental",\n    "value": {\n      "type": "counter",\n      "value": 1.0\n    }\n  },\n  {\n    "name": "logins",\n    "kind": "incremental",\n    "value": {\n      "type": "counter",\n      "value": 3.0\n    }\n  }\n]\n\nThis sink will output the following:\n\n```text title="Example sink output"\n# HELP logins logins\n# TYPE logins counter\nlogins 4\n'))),Object(r.b)(l.a,{value:"gauges",mdxType:"TabItem"},Object(r.b)("p",null,"Given the following gauge metric events:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json",metastring:'title="Example gauge metrics"',title:'"Example',gauge:!0,'metrics"':!0}),'[\n  {\n    "name": "memory_rss",\n    "kind": "incremental",\n    "value": {\n      "type": "gauge",\n      "value": 250.0\n    }\n  },\n  {\n    "name": "memory_rss",\n    "kind": "incremental",\n    "value": {\n      "type": "gauge",\n      "value": -25.0\n    }\n  }\n]\n')),Object(r.b)("p",null,"This sink will output the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text",metastring:'title="Example sink output"',title:'"Example',sink:!0,'output"':!0}),"# HELP memory_rss memory_rss\n# TYPE memory_rss gauge\nmemory_rss 225\n")))),Object(r.b)("h2",{id:"how-it-works"},"How It Works"),Object(r.b)("h3",{id:"buffers"},"Buffers"),Object(r.b)("p",null,"Due to the nature of Prometheus' pull model design the ",Object(r.b)("inlineCode",{parentName:"p"},"prometheus"),"\nsink does not utilize a buffer. You can read more about this in the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#in-memory-aggregation"}),"in-memory \\\naggregation")," section."),Object(r.b)("h3",{id:"environment-variables"},"Environment Variables"),Object(r.b)("p",null,"Environment variables are supported through all of Vector's configuration.\nSimply add ",Object(r.b)("inlineCode",{parentName:"p"},"${MY_ENV_VAR}")," in your Vector configuration file and the variable\nwill be replaced before being evaluated."),Object(r.b)("p",null,"You can learn more in the\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/setup/configuration/#environment-variables"}),"Environment Variables")," section."),Object(r.b)("h3",{id:"exposing--scraping"},"Exposing & Scraping"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"prometheus")," sink exposes data for scraping.\nThe ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#address"}),Object(r.b)("inlineCode",{parentName:"a"},"address"))," option determines the address and port the data is made available\non. You'll need to configure your networking so that the configured port is\naccessible by the downstream service doing the scraping."),Object(r.b)("h3",{id:"high-cardinality-names"},"High Cardinality Names"),Object(r.b)("p",null,"High cardinality metric names and labels are ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://prometheus.io/docs/practices/naming/#labels"}),"discouraged by \\\nPrometheus")," and you should consider alternative\nstrategies to reduce the cardinality as this can provide performance and\noperation problems. In general, high cardinality analysis should be left logs\nand storages designed for this use case (not Promtheus)."),Object(r.b)("h3",{id:"histogram-buckets"},"Histogram Buckets"),Object(r.b)("p",null,"Choosing the appropriate buckets for Prometheus histgorams is a complicated\npoint of discussion. The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://prometheus.io/docs/practices/histograms/"}),"Histograms and Summaries Prometheus \\\nguide")," provides a good overview of histograms,\nbuckets, summaries, and how you should think about configuring them. The buckets\nyou choose should align with your known range and distribution of values as\nwell as how you plan to report on them. The aforementioned guide provides\nexamples on how you should align them."),Object(r.b)("h4",{id:"default-buckets"},"Default buckets"),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#buckets"}),Object(r.b)("inlineCode",{parentName:"a"},"buckets"))," option defines the global default buckets for histograms:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-toml"}),"[0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1.0, 2.5, 5.0, 10.0]\n")),Object(r.b)("p",null,"These defaults are tailored to broadly measure the response time (in seconds)\nof a network service. Most likely, however, you will be required to define\nbuckets customized to your use case."),Object(r.b)(i.a,{type:"warning",mdxType:"Alert"},Object(r.b)("p",null,"Note: These values are in ",Object(r.b)("inlineCode",{parentName:"p"},"seconds"),", therefore,\nyour metric values should also be in ",Object(r.b)("inlineCode",{parentName:"p"},"seconds"),".\nIf this is not the case you should adjust your metric or buckets to coincide.")),Object(r.b)("h3",{id:"in-memory-aggregation"},"In-Memory Aggregation"),Object(r.b)("p",null,"Like other Prometheus instances, the ",Object(r.b)("inlineCode",{parentName:"p"},"prometheus")," sink aggregates\nmetrics in memory which keeps the memory footprint to a minimum if Prometheus\nfails to scrape the Vector instance over an extended period of time. The\ndownside is that data will be lost if Vector is restarted. This is by design of\nPrometheus' pull model approach, but is worth noting if restart Vector\nfrequently."),Object(r.b)("h3",{id:"metric-definitions"},"Metric Definitions"),Object(r.b)("p",null,"By default, Vector will use the original metric names and labels set upon\ncreation. For most cases this makes Vector low friction, allowing you to define\nthe ",Object(r.b)("inlineCode",{parentName:"p"},"prometheus")," sink without tedious metrics definitions. You can\nsee examples of this in the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#examples"}),"examples section"),"."),Object(r.b)("h3",{id:"metric-types"},"Metric Types"),Object(r.b)("p",null,"As described in the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/about/data-model/metric/"}),"metric data model")," page, Vector offers\na variety of metric types. Their support, as as well as their mappings, are\ndescribed below:"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"left"}),"Vector Metric Type"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:"left"}),"Prometheus Metric Type"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"/docs/about/data-model/metric/#counter"}),Object(r.b)("inlineCode",{parentName:"a"},"counter"))),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://prometheus.io/docs/concepts/metric_types/#counter"}),"'counter'"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"/docs/about/data-model/metric/#gauge"}),Object(r.b)("inlineCode",{parentName:"a"},"gauge"))),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://prometheus.io/docs/concepts/metric_types/#gauge"}),"'gauge'"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"/docs/about/data-model/metric/#aggregated_histogram"}),Object(r.b)("inlineCode",{parentName:"a"},"histogram"))),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://prometheus.io/docs/concepts/metric_types/#histogram"}),"'histogram'"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"/docs/about/data-model/metric/#set"}),Object(r.b)("inlineCode",{parentName:"a"},"set"))),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),"\u26a0\ufe0f not supported")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),"-"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://prometheus.io/docs/concepts/metric_types/#summary"}),"'summary'"))))),Object(r.b)("h4",{id:"sets"},"Sets"),Object(r.b)("p",null,"Prometheus does not have a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/about/data-model/metric/#set"}),Object(r.b)("inlineCode",{parentName:"a"},"set"))," type. Sets are\ngenerally specific to ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/statsd/statsd/blob/master/docs/metric_types.md#sets"}),"Statsd"),", and if a set is received in the\n",Object(r.b)("inlineCode",{parentName:"p"},"prometheus")," sink it will be dropped, and a rate limited warning\nlevel log will be output."),Object(r.b)("h4",{id:"summaries"},"Summaries"),Object(r.b)("p",null,"Summaries are a Prometheus specific type and Vector does not default to them\nby default. ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/timberio/vector/issues/710"}),"issue #710")," addresses the ability to define metrics,\nincluding the ability change their types (such as changing them to ",Object(r.b)("inlineCode",{parentName:"p"},"summary"),"\ntypes)."),Object(r.b)("h4",{id:"oom-errors"},"OOM Errors"),Object(r.b)("p",null,"If you experience out of memory (OOM) errors it's likely you're using extremely\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#high-cardinality"}),"high cardinality")," metric names or labels. This is\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://prometheus.io/docs/practices/naming/#labels"}),"discouraged by Prometheus")," and you should\nconsider alternative strategies to reduce the cardinality. Such as leveraging\nlogs for high cardinality analysis. ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/timberio/vector/issues/387"}),"Issue #387")," discusses the\nability to provide safeguards around this. We encourage you to add to that\ndiscussion with your use case if you find this to be a problem."))}d.isMDXComponent=!0}}]);