(window.webpackJsonp=window.webpackJsonp||[]).push([[446],{1139:function(e,t,n){"use strict";var a=n(24),l=n(13),r=n(27),i=n(84),c=n(85),s=n(26),o=n(1145),u=n(86);l(l.S+l.F*!n(81)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,l,m,p=r(e),d="function"==typeof this?this:Array,b=arguments.length,h=b>1?arguments[1]:void 0,f=void 0!==h,v=0,g=u(p);if(f&&(h=a(h,b>2?arguments[2]:void 0,2)),null==g||d==Array&&c(g))for(n=new d(t=s(p.length));t>v;v++)o(n,v,f?h(p[v],v):p[v]);else for(m=g.call(p),n=new d;!(l=m.next()).done;v++)o(n,v,f?i(m,h,[l.value,v],!0):l.value);return n.length=v,n}})},1140:function(e,t,n){"use strict";var a=n(1146),l=n(1141);e.exports=n(1147)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return a.def(l(this,"Set"),e=0===e?0:e,e)}},a)},1141:function(e,t,n){var a=n(12);e.exports=function(e,t){if(!a(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},1142:function(e,t,n){"use strict";var a=n(0),l=n.n(a),r=n(1137),i=n(1136),c=n.n(i);n(131);t.a=function(e){var t=e.className,n=e.size,a=e.style,i=e.text;return l.a.createElement(r.a,{to:"/vic/",className:c()("vic","vic--"+n,t)},l.a.createElement("div",{className:"icon"},l.a.createElement("img",{src:"/img/vicmojis/vic"+a+".svg",alt:"Vic - The Vector Mascot"})),i&&l.a.createElement("div",{className:"text"},i))}},1144:function(e,t,n){"use strict";var a=n(0),l=n.n(a),r=(n(1137),n(1142));t.a=function(e){var t=e.text;return l.a.createElement("section",{className:"empty"},l.a.createElement(r.a,{style:"no",text:t}))}},1145:function(e,t,n){"use strict";var a=n(28),l=n(53);e.exports=function(e,t,n){t in e?a.f(e,t,l(0,n)):e[t]=n}},1146:function(e,t,n){"use strict";var a=n(28).f,l=n(82),r=n(80),i=n(24),c=n(78),s=n(79),o=n(54),u=n(83),m=n(87),p=n(10),d=n(1143).fastKey,b=n(1141),h=p?"_s":"size",f=function(e,t){var n,a=d(t);if("F"!==a)return e._i[a];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,o){var u=e((function(e,a){c(e,u,t,"_i"),e._t=t,e._i=l(null),e._f=void 0,e._l=void 0,e[h]=0,null!=a&&s(a,n,e[o],e)}));return r(u.prototype,{clear:function(){for(var e=b(this,t),n=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete n[a.i];e._f=e._l=void 0,e[h]=0},delete:function(e){var n=b(this,t),a=f(n,e);if(a){var l=a.n,r=a.p;delete n._i[a.i],a.r=!0,r&&(r.n=l),l&&(l.p=r),n._f==a&&(n._f=l),n._l==a&&(n._l=r),n[h]--}return!!a},forEach:function(e){b(this,t);for(var n,a=i(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(a(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!f(b(this,t),e)}}),p&&a(u.prototype,"size",{get:function(){return b(this,t)[h]}}),u},def:function(e,t,n){var a,l,r=f(e,t);return r?r.v=n:(e._l=r={i:l=d(t,!0),k:t,v:n,p:a=e._l,n:void 0,r:!1},e._f||(e._f=r),a&&(a.n=r),e[h]++,"F"!==l&&(e._i[l]=r)),e},getEntry:f,setStrong:function(e,t,n){o(e,t,(function(e,n){this._t=b(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))}),n?"entries":"values",!n,!0),m(t)}}},1147:function(e,t,n){"use strict";var a=n(5),l=n(13),r=n(15),i=n(80),c=n(1143),s=n(79),o=n(78),u=n(12),m=n(14),p=n(81),d=n(39),b=n(1148);e.exports=function(e,t,n,h,f,v){var g=a[e],y=g,O=f?"set":"add",j=y&&y.prototype,_={},w=function(e){var t=j[e];r(j,e,"delete"==e||"has"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof y&&(v||j.forEach&&!m((function(){(new y).entries().next()})))){var E=new y,x=E[O](v?{}:-0,1)!=E,N=m((function(){E.has(1)})),T=p((function(e){new y(e)})),C=!v&&m((function(){for(var e=new y,t=5;t--;)e[O](t,t);return!e.has(-0)}));T||((y=t((function(t,n){o(t,y,e);var a=b(new g,t,y);return null!=n&&s(n,f,a[O],a),a}))).prototype=j,j.constructor=y),(N||C)&&(w("delete"),w("has"),f&&w("get")),(C||x)&&w(O),v&&j.clear&&delete j.clear}else y=h.getConstructor(t,e,f,O),i(y.prototype,n),c.NEED=!0;return d(y,e),_[e]=y,l(l.G+l.W+l.F*(y!=g),_),v||h.setStrong(y,e,f),y}},1148:function(e,t,n){var a=n(12),l=n(1149).set;e.exports=function(e,t,n){var r,i=t.constructor;return i!==n&&"function"==typeof i&&(r=i.prototype)!==n.prototype&&a(r)&&l&&l(e,r),e}},1149:function(e,t,n){var a=n(12),l=n(8),r=function(e,t){if(l(e),!a(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,a){try{(a=n(24)(Function.call,n(1163).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(l){t=!0}return function(e,n){return r(e,n),t?e.__proto__=n:a(e,n),e}}({},!1):void 0),check:r}},1150:function(e,t,n){"use strict";n(1140),n(77),n(1139),n(25),n(20),n(19),n(1138);var a=n(0),l=n.n(a),r=n(1157),i=n.n(r);t.a=function(e){var t=e.currentState,n=e.humanize,a=e.icon,r=e.name,c=e.setState,s=e.values;if(0==s.size)return null;var o=Array.from(s);return l.a.createElement(l.a.Fragment,null,o.map((function(e,s){var o="string"==typeof e&&n?i()(e):e;return l.a.createElement("label",{key:s},l.a.createElement("input",{checked:t.has(e),name:r,onChange:function(n){var a=new Set(t);n.currentTarget.checked?a.add(e):a.delete(e),c(a)},type:"checkbox"}),o&&l.a.createElement(l.a.Fragment,null,a?l.a.createElement("i",{className:"feather icon-"+a}):""," ",o))})))}},1153:function(e,t,n){"use strict";var a=n(13),l=n(1154),r=n(27),i=n(26),c=n(29),s=n(1166);a(a.P,"Array",{flatMap:function(e){var t,n,a=r(this);return c(e),t=i(a.length),n=s(a,0),l(n,a,a,t,0,1,e,arguments[1]),n}}),n(88)("flatMap")},1154:function(e,t,n){"use strict";var a=n(1165),l=n(12),r=n(26),i=n(24),c=n(2)("isConcatSpreadable");e.exports=function e(t,n,s,o,u,m,p,d){for(var b,h,f=u,v=0,g=!!p&&i(p,d,3);v<o;){if(v in s){if(b=g?g(s[v],v,n):s[v],h=!1,l(b)&&(h=void 0!==(h=b[c])?!!h:a(b)),h&&m>0)f=e(t,n,b,r(b.length),f,m-1)-1;else{if(f>=9007199254740991)throw TypeError();t[f]=b}f++}v++}return f}},1155:function(e,t,n){"use strict";n(1138),n(1151),n(1152),n(1139),n(1153),n(25),n(20),n(19),n(77),n(1140);var a=n(0),l=n.n(a),r=n(1150),i=n(1144),c=n(1158),s=n.n(c);t.a=function(e){var t=e.children,n=e.filters,c=Object(a.useState)(!1),o=c[0],u=c[1],m=Object(a.useState)(new Set),p=m[0],d=m[1],b=Object(a.useState)(!1),h=b[0],f=b[1],v=Object(a.useState)(null),g=v[0],y=v[1],O=[];t&&(O=Array.isArray(t)?t:[t]);var j=O.some((function(e){return e.props.common})),_=s()(O).flatMap((function(e){return e.props.groups})).uniq().value(),w=O.some((function(e){return e.props.required})),E=O;return o&&(E=E.filter((function(e){return e.props.common}))),p.size>0&&(E=E.filter((function(e){return Array.from(p).every((function(t){return e.props.groups.includes(t)}))}))),h&&(E=E.filter((function(e){return e.props.required}))),g&&(E=E.filter((function(e){return e.props.name.toLowerCase().includes(g.toLowerCase())}))),l.a.createElement(l.a.Fragment,null,O.length>1&&!1!==n?l.a.createElement("div",{className:"filters"},l.a.createElement("div",{className:"search"},l.a.createElement("span",{className:"search--result-count"},E.length," items"),l.a.createElement("input",{className:"input--text input--lg",type:"text",onChange:function(e){return y(e.currentTarget.value)},placeholder:"\ud83d\udd0d Search..."})),l.a.createElement("div",{className:"filter"},l.a.createElement("div",{className:"filter--choices"},l.a.createElement(r.a,{values:_,currentState:p,setState:d}),j&&l.a.createElement("label",{title:"Only show popular/common results"},l.a.createElement("input",{type:"checkbox",onChange:function(e){return u(e.currentTarget.checked)},checked:o}),"common"),w&&l.a.createElement("label",{title:"Only show required results"},l.a.createElement("input",{type:"checkbox",onChange:function(e){return f(e.currentTarget.checked)},checked:h}),"required")))):null,!Array.isArray(E)||E.length>0?l.a.createElement("ul",{className:"connected-list"},E):l.a.createElement(i.a,{text:"no components found"}))}},1156:function(e,t,n){"use strict";n(89),n(25),n(20),n(19),n(52),n(1138),n(1151),n(1152);var a=n(0),l=n.n(a),r=n(1136),i=n.n(r),c=(n(1128),n(1167));function s(e){return e.includes(".")?'"'+e+'"':e}function o(e){return"string"==typeof e&&e.includes("\n")?'"""\n'+e+'\n"""':JSON.stringify(e)}function u(e,t){return(n=t)&&n.constructor===Object?"name"in t&&"value"in t?s(t.name)+" = "+o(t.value):s(Object.keys(t)[0])+" = "+o(Object.values(t)[0]):e?s(e)+" = "+o(t):o(t);var n}function m(e){var t=e.values,n=[];if(Array.isArray(t))for(var a in t){var r=t[a];n.push(l.a.createElement("code",{key:r},o(r))),n.push(" ")}else for(var i in t)n.push(l.a.createElement("code",{key:i,className:"with-info-icon",title:t[i]},o(i))),n.push(" ");return n}function p(e){var t=e.name,n=e.path,a=e.values,r="";return a.forEach((function(e){n&&(r+=n+"."),r+=u(t,e)+"\n"})),l.a.createElement("div",null,l.a.createElement(c.a,{className:"language-toml"},r))}function d(e){var t=e.unit,n=e.value,a="";return t&&(a=l.a.createElement(l.a.Fragment,null," (",t,")")),l.a.createElement(l.a.Fragment,null,l.a.createElement("code",null,o(n)),a)}function b(e){var t=e.value,n=Object.keys(t)[0],a=Object.values(t)[0];return""==a&&(a=null),l.a.createElement("span",null,l.a.createElement("code",null,l.a.createElement("a",{href:"#"+n},n))," ","= ",l.a.createElement("code",null,o(a)))}function h(e){var t=e.defaultValue,n=e.enumValues,r=e.examples,i=(e.groups,e.name),c=e.path,s=e.relevantWhen,o=e.required,u=e.unit,h=e.warnings,f=Object(a.useState)(!1),v=f[0],g=f[1];return l.a.createElement("ul",{className:"info"},h&&h.length>0&&h.map((function(e,t){return l.a.createElement("li",{key:t,className:"warning"},l.a.createElement("i",{className:"feather icon-alert-triangle"})," WARNING:"," ",e.text)})),s&&l.a.createElement("li",null,"Only ",o?"required":"relevant"," when:"," ",l.a.createElement(b,{value:s})),void 0!==t?null!==t?l.a.createElement("li",null,"Default: ",l.a.createElement(d,{unit:u,value:t})):l.a.createElement("li",null,"No default"):null,n&&l.a.createElement("li",null,"Enum, must be one of: ",l.a.createElement(m,{values:n})),(r.length>1||r[0]!=t)&&l.a.createElement("li",null,l.a.createElement("div",{className:"show-more",onClick:function(){return g(!v)}},v?"Hide examples":"View examples"),v&&l.a.createElement(p,{name:i,path:c,values:r})))}t.a=function(e){var t=e.children,n=e.common,r=e.defaultValue,c=e.enumValues,s=e.examples,o=e.groups,u=e.name,m=e.path,p=e.relevantWhen,d=e.required,b=e.templateable,f=e.type,v=e.unit,g=e.warnings,y=Object(a.useState)(!1),O=y[0],j=(y[1],t);return O&&(j=j.filter((function(e){return"p"!=e.props.originalType}))),l.a.createElement("li",{className:i()({"field-required":d,"field-collapsed":O}),required:d},l.a.createElement("div",{className:"badges"},b&&l.a.createElement("span",{className:"badge badge--primary with-info-icon",title:"This option is dynamic and accepts the Vector template syntax"},"templateable"),f&&l.a.createElement("span",{className:"badge badge--secondary"},f,v&&l.a.createElement(l.a.Fragment,null," (",v,")")),c&&Object.keys(c).length>0&&l.a.createElement("span",{className:"badge badge--secondary with-info-icon",title:"This option is an enumation and only allows specific values"},"enum"),n&&l.a.createElement("span",{className:"badge badge--primary with-info-icon",title:"This is a popular that we recommend for getting started"},"common"),d?l.a.createElement("span",{className:"badge badge--danger"},"required",p&&"*"):l.a.createElement("span",{className:"badge badge--secondary"},"optional")),j,!O&&"table"!=f&&l.a.createElement(h,{defaultValue:r,enumValues:c,examples:s,groups:o,name:u,path:m,relevantWhen:p,required:d,unit:v,warnings:g}))}},602:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return m})),n.d(t,"metadata",(function(){return p})),n.d(t,"rightToc",(function(){return d})),n.d(t,"default",(function(){return h}));var a=n(1),l=n(9),r=(n(0),n(1128)),i=n(1172),c=n(1155),s=n(1156),o=n(1161),u=n(1160),m={last_modified_on:"2020-06-10",component_title:"AWS EC2 Metadata",description:"The Vector `aws_ec2_metadata` transform accepts and outputs `log` events, allowing you to enrich logs with AWS EC2 instance metadata.",event_types:["log"],function_category:"enrich",issues_url:"https://github.com/timberio/vector/issues?q=is%3Aopen+is%3Aissue+label%3A%22transform%3A+aws_ec2_metadata%22",operating_systems:["Linux","MacOS","Windows"],sidebar_label:'aws_ec2_metadata|["log"]',source_url:"https://github.com/timberio/vector/tree/master/src/transforms/aws_ec2_metadata.rs",status:"beta",title:"AWS EC2 Metadata Transform",unsupported_operating_systems:[]},p={id:"reference/transforms/aws_ec2_metadata",title:"AWS EC2 Metadata Transform",description:"The Vector `aws_ec2_metadata` transform accepts and outputs `log` events, allowing you to enrich logs with AWS EC2 instance metadata.",source:"@site/docs/reference/transforms/aws_ec2_metadata.md",permalink:"/docs/reference/transforms/aws_ec2_metadata",editUrl:"https://github.com/timberio/vector/edit/master/website/docs/reference/transforms/aws_ec2_metadata.md",sidebar_label:'aws_ec2_metadata|["log"]',sidebar:"docs",previous:{title:"ANSI Stripper Transform",permalink:"/docs/reference/transforms/ansi_stripper"},next:{title:"Coercer Transform",permalink:"/docs/reference/transforms/coercer"}},d=[{value:"Requirements",id:"requirements",children:[]},{value:"Configuration",id:"configuration",children:[{value:"fields",id:"fields",children:[]},{value:"host",id:"host",children:[]},{value:"namespace",id:"namespace",children:[]},{value:"refresh_interval_secs",id:"refresh_interval_secs",children:[]}]},{value:"Fields",id:"fields-1",children:[{value:"ami-id",id:"ami-id",children:[]},{value:"availability-zone",id:"availability-zone",children:[]},{value:"instance-id",id:"instance-id",children:[]},{value:"local-hostname",id:"local-hostname",children:[]},{value:"local-ipv4",id:"local-ipv4",children:[]},{value:"public-hostname",id:"public-hostname",children:[]},{value:"public-ipv4",id:"public-ipv4",children:[]},{value:"region",id:"region",children:[]},{value:"role-name",id:"role-name",children:[]},{value:"subnet-id",id:"subnet-id",children:[]},{value:"vpc-id",id:"vpc-id",children:[]}]},{value:"How It Works",id:"how-it-works",children:[{value:"AWS IMDS v2",id:"aws-imds-v2",children:[]},{value:"Complex Processing",id:"complex-processing",children:[]},{value:"Environment Variables",id:"environment-variables",children:[]}]}],b={rightToc:d};function h(e){var t=e.components,n=Object(l.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"The Vector ",Object(r.b)("inlineCode",{parentName:"p"},"aws_ec2_metadata")," transform\naccepts and outputs ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/about/data-model/log/"}),Object(r.b)("inlineCode",{parentName:"a"},"log"))," events, allowing you to enrich\nlogs with AWS EC2 instance metadata."),Object(r.b)("h2",{id:"requirements"},"Requirements"),Object(r.b)(i.a,{icon:!1,type:"danger",className:"list--icons list--icons--warnings",mdxType:"Alert"},Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html"}),"AWS IMDS v2")," is required. This is available by default on EC2."),Object(r.b)("li",{parentName:"ul"},"Running this transform within Docker on EC2 requires 2 network hops. Users must raise this limit. See the ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/reference/transforms/aws_ec2_metadata/#aws-imds-v2"}),'"AWS imDS v2" section')," for more info."))),Object(r.b)("h2",{id:"configuration"},"Configuration"),Object(r.b)(o.a,{block:!0,defaultValue:"common",values:[{label:"Common",value:"common"},{label:"Advanced",value:"advanced"}],mdxType:"Tabs"},Object(r.b)(u.a,{value:"common",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-toml",metastring:'title="vector.toml"',title:'"vector.toml"'}),'[transforms.my_transform_id]\n  type = "aws_ec2_metadata" # required\n  inputs = ["my-source-or-transform-id"] # required\n  fields = ["instance-id", "local-hostname", "local-ipv4", "public-hostname", "public-ipv4", "ami-id", "availability-zone", "vpc-id", "subnet-id", "region"] # optional, default\n  host = "http://169.254.169.254" # optional, default\n  namespace = "" # optional, default\n  refresh_interval_secs = 10 # optional, default\n'))),Object(r.b)(u.a,{value:"advanced",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-toml",metastring:'title="vector.toml"',title:'"vector.toml"'}),'[transforms.my_transform_id]\n  type = "aws_ec2_metadata" # required\n  inputs = ["my-source-or-transform-id"] # required\n  fields = ["instance-id", "local-hostname", "local-ipv4", "public-hostname", "public-ipv4", "ami-id", "availability-zone", "vpc-id", "subnet-id", "region"] # optional, default\n  host = "http://169.254.169.254" # optional, default\n  namespace = "" # optional, default\n  refresh_interval_secs = 10 # optional, default\n')))),Object(r.b)(c.a,{filters:!0,mdxType:"Fields"},Object(r.b)(s.a,{common:!0,defaultValue:["instance-id","local-hostname","local-ipv4","public-hostname","public-ipv4","ami-id","availability-zone","vpc-id","subnet-id","region"],enumValues:null,examples:[["instance-id","local-hostname","local-ipv4","public-hostname","public-ipv4","ami-id","availability-zone","vpc-id","subnet-id","region"]],groups:[],name:"fields",path:null,relevantWhen:null,required:!1,templateable:!1,type:"[string]",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"fields"},"fields"),Object(r.b)("p",null,"A list of fields to include in each event.")),Object(r.b)(s.a,{common:!0,defaultValue:"http://169.254.169.254",enumValues:null,examples:["http://169.254.169.254"],groups:[],name:"host",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"host"},"host"),Object(r.b)("p",null,"Override the default EC2 Metadata host.")),Object(r.b)(s.a,{common:!0,defaultValue:"",enumValues:null,examples:["","ec2","aws.ec2"],groups:[],name:"namespace",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"namespace"},"namespace"),Object(r.b)("p",null,"Prepend a namespace to each field's key.")),Object(r.b)(s.a,{common:!0,defaultValue:10,enumValues:null,examples:[10],groups:[],name:"refresh_interval_secs",path:null,relevantWhen:null,required:!1,templateable:!1,type:"uint",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"refresh_interval_secs"},"refresh_interval_secs"),Object(r.b)("p",null,"The interval in seconds at which the EC2 Metadata api will be called."))),Object(r.b)("h2",{id:"fields-1"},"Fields"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript",metastring:'title="example log event"',title:'"example',log:!0,'event"':!0}),'{\n  // ...\n  "ami-id": "ami-00068cd7555f543d5",\n  "availability-zone": "54.234.246.107",\n  "instance-id": "i-096fba6d03d36d262",\n  "local-hostname": "ip-172-31-93-227.ec2.internal",\n  "local-ipv4": "172.31.93.227",\n  "public-hostname": "ec2-54-234-246-107.compute-1.amazonaws.com",\n  "public-ipv4": "54.234.246.107",\n  "region": "us-east-1",\n  "role-name": "some_iam_role",\n  "subnet-id": "subnet-9d6713b9",\n  "vpc-id": "vpc-a51da4dc"\n  // ...\n}\n')),Object(r.b)(c.a,{filters:!0,mdxType:"Fields"},Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["ami-00068cd7555f543d5"],groups:[],name:"ami-id",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"ami-id"},"ami-id"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"ami-id")," that the current EC2 instance is using.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["54.234.246.107"],groups:[],name:"availability-zone",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"availability-zone"},"availability-zone"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"availability-zone")," that the current EC2 instance is running in.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["i-096fba6d03d36d262"],groups:[],name:"instance-id",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"instance-id"},"instance-id"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"instance-id")," of the current EC2 instance.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["ip-172-31-93-227.ec2.internal"],groups:[],name:"local-hostname",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"local-hostname"},"local-hostname"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"local-hostname")," of the current EC2 instance.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["172.31.93.227"],groups:[],name:"local-ipv4",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"local-ipv4"},"local-ipv4"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"local-ipv4")," of the current EC2 instance.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["ec2-54-234-246-107.compute-1.amazonaws.com"],groups:[],name:"public-hostname",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"public-hostname"},"public-hostname"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"public-hostname")," of the current EC2 instance.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["54.234.246.107"],groups:[],name:"public-ipv4",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"public-ipv4"},"public-ipv4"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"public-ipv4")," of the current EC2 instance.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["us-east-1"],groups:[],name:"region",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"region"},"region"),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#region"}),Object(r.b)("inlineCode",{parentName:"a"},"region"))," that the current EC2 instance is running in.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["some_iam_role"],groups:[],name:"role-name",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"role-name"},"role-name"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"role-name")," that the current EC2 instance is using.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["subnet-9d6713b9"],groups:[],name:"subnet-id",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"subnet-id"},"subnet-id"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"subnet-id")," of the current EC2 instance's default network interface.")),Object(r.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:["vpc-a51da4dc"],groups:[],name:"vpc-id",path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,warnings:[],mdxType:"Field"},Object(r.b)("h3",{id:"vpc-id"},"vpc-id"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"vpc-id")," of the current EC2 instance's default network interface."))),Object(r.b)("h2",{id:"how-it-works"},"How It Works"),Object(r.b)("h3",{id:"aws-imds-v2"},"AWS IMDS v2"),Object(r.b)("p",null,"v2 of the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html"}),"AWS IMDS service")," addresses ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/"}),"a number\nof very serious security issues")," with v1.\nAs part of tighening security, Amazon limited the number of network hops allowed\nto communicate with this service to 1. Unfortunately, when running Vector within\nDocker this introduces an additional hop. Therefore, you ",Object(r.b)("em",{parentName:"p"},"must")," configure your\nAWS instances to allow for 2 hops:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"aws ec2 modify-instance-metadata-options --instance-id <ID> --http-endpoint enabled --http-put-response-hop-limit 2\n")),Object(r.b)("p",null,"If you do not raise this limit the ",Object(r.b)("inlineCode",{parentName:"p"},"aws_ec2_metadata")," transform will not work."),Object(r.b)("h3",{id:"complex-processing"},"Complex Processing"),Object(r.b)("p",null,"If you encounter limitations with the ",Object(r.b)("inlineCode",{parentName:"p"},"aws_ec2_metadata"),"\ntransform then we recommend using a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://vector.dev/components/?functions%5B%5D=program"}),"runtime transform"),".\nThese transforms are designed for complex processing and give you the power of\nfull programming runtime."),Object(r.b)("h3",{id:"environment-variables"},"Environment Variables"),Object(r.b)("p",null,"Environment variables are supported through all of Vector's configuration.\nSimply add ",Object(r.b)("inlineCode",{parentName:"p"},"${MY_ENV_VAR}")," in your Vector configuration file and the variable\nwill be replaced before being evaluated."),Object(r.b)("p",null,"You can learn more in the\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/setup/configuration/#environment-variables"}),"Environment Variables")," section."))}h.isMDXComponent=!0}}]);